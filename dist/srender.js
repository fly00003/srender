!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.srender=e():t.srender=e()}(window,function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var i=2311,o=function(){return i++},r={},s=function(){return r.createCanvas()};r.createCanvas=function(){return console.log("createdom"),document.createElement("canvas")};var a=function(){this._roots=[],this._displayList=[],this._displayListLen=0};a.prototype={constructor:a,traverse:function(t,e){for(var n=0;n<this._roots.length;n++)this._roots[n].traverse(t,e)},getDisplayList:function(t){return t&&this.updateDisplayList(),this._displayList},updateDisplayList:function(){this._displayListLen=0;for(var t=this._roots,e=this._displayList,n=0,i=t.length;n<i;n++){var o=t[n];this._displayList[this._displayListLen++]=o}e.length=this._displayListLen},addRoot:function(t){t.__storage!==this&&(this.addToStorage(t),this._roots.push(t))},delRoot:function(t){if(null==t)return this._roots=[],this._displayList=[],void(this._displayListLen=0);if(t instanceof Array)for(var e=0,n=t.length;e<n;e++)this.delRoot(t[e]);else{var i=function(t,e){if(t){if(t.indexOf)return t.indexOf(e);for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n}return-1}(this._roots,t);i>=0&&(this.delFromStorage(t),this._roots.splice(i,1))}},addToStorage:function(t){return t&&(t.__storage=this,t.dirty(!1)),this},delFromStorage:function(t){return t&&(t.__storage=null,t.__dirty=!0),this},dispose:function(){this._renderList=this._roots=null}};var d=a,u=1;"undefined"!=typeof window&&(u=Math.max(window.devicePixelRatio||1,1));var h=u;function c(t,e,n){var i=s(),o=e.getWidth(),r=e.getHeight();console.log("newDom");var a=i.style;return a&&(console.log("进入分支"),a.position="absolute",a.border="1px dashed gray",a.left=0,a.top=0,a.width=o+"px",a.height=r+"px",i.setAttribute("data-zr-dom-id",t)),console.log(o),console.log(r),i.width=1e3,i.height=800,console.log(i.width),console.log(i.height),i}var l=function(t,e,n){var i;n=n||h,"string"==typeof t?i=c(t,e):function(t){var e=typeof t;return"function"===e||!!t&&"object"==e}(t)&&(t=(i=t).id),i=c(t,e),this.id=t,this.dom=i,this.painter=e,this.dpr=n};l.prototype={constructor:l,__dirty:!0,__used:!1,__drawIndex:0,__startIndex:0,__endIndex:0,incremental:!1,getElementCount:function(){return this.__endIndex-this.__startIndex},initContext:function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},clear:function(){var t=this.dom,e=this.ctx,n=t.width,i=t.height;e.clearRect(0,0,n,i)}};var f=l;function p(t){return parseInt(t,10)}var g=function(t,e,n){this.root=t;var i=t.style;i&&(i["-webkit-tap-highlight-color"]="transparent",i["-webkit-user-select"]=i["user-select"]=i["-webkit-touch-callout"]="none",t.innerHTML=""),this.storage=e;this._layers={};var o=i.width,r=i.height;null!=n.width&&(o=n.width),null!=n.height&&(r=n.height),this.dpr=n.devicePixelRatio||1,t.width=o*this.dpr,t.height=r*this.dpr,this._width=o,this._height=r;var s=new f(t,this,this.dpr);s.__builtin__=!0,s.initContext(),this.tempLayer=s,t.appendChild(s.dom),this._domRoot=t,this.cnv=document.getElementsByTagName("canvas")[0]};g.prototype={constructor:g,getWidth:function(){return this._width},getHeight:function(){return this._height},getType:function(){return"canvas"},getViewportRoot:function(){return this._domRoot},refresh:function(t){var e=this.storage.getDisplayList(!0),n=this.storage._displayListLen,i=this.tempLayer.ctx;if(t){this.tempLayer.clear();for(var o=0;o<n;o++){var r=e[o];i.beginPath(),i.stokeStyle="red",r.buildPath(i,r.shape),i.stroke(),r.__dirty=!1}}else for(o=0;o<n;o++){r=e[o];console.log(r.shape),!0===r.__dirty&&(i.beginPath(),i.stokeStyle="red",r.buildPath(i,r.shape),i.stroke(),r.__dirty=!1)}return this},_getSize:function(t){var e=this._opts,n=["width","height"][t],i=["clientWidth","clientHeight"][t],o=["paddingLeft","paddingTop"][t],r=["paddingRight","paddingBottom"][t];if(null!=e[n]&&"auto"!==e[n])return parseFloat(e[n]);var s=this.root,a=document.defaultView.getComputedStyle(s);return(s[i]||p(a[n])||p(s.style[n]))-(p(a[o])||0)-(p(a[r])||0)|0}};var _=g,y=("undefined"!=typeof window&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame),function(t,e,n){this.root=t,this.storage=e,this.painter=n;var i={x:0,y:0};n.cnv.addEventListener("mousemove",function(t){var e,o;(t=t||window.event).pageX||t.pageY?(e=t.pageX,o=t.pageY):(e=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,o=t.clientY+document.body.scrollTop+document.documentElement.scrollTop),e-=n.cnv.offsetLeft,o-=n.cnv.offsetTop,i.x=e,i.y=o},!1);var o=0,r=0,s=!1,a=e.getDisplayList(!0),d=null;function u(){null!=d&&(console.log("_move"),d.shape.cx=i.x-o,d.shape.cy=i.y-r,console.log(d.shape.cx,d.shape.cy),d.__dirty=!0)}function h(){d=null,s=!1,document.removeEventListener("mouseup",h,!1),document.removeEventListener("mousemove",u,!1)}console.log(n.cnv),n.cnv.addEventListener("mousedown",function(){for(var t of a)if(t.checkMouse(i)){d=t,console.log("mouwn"),s=!0;break}o=i.x-d.shape.cx,r=i.y-d.shape.cy,document.addEventListener("mousemove",u,!1),document.addEventListener("mouseup",h,!1)},!1),setInterval(function(){s&&n.refresh(!0)},16)});function m(t){t=t||{},this.shape=t.shape||{cx:0,cy:0,r:20},this.__dirty=!0,this.__sr=null}m.prototype={checkMouse:function(t){var e=this.shape,n=t.x-e.cx,i=t.y-e.cy;return Math.sqrt(n*n+i*i)<e.r},dirty:function(){},buildPath:function(t,e){e=this.shape;t.arc(e.cx,e.cy,e.r,0,2*Math.PI,!0)}},n.d(e,"init",function(){return w}),n.d(e,"dispose",function(){return x}),n.d(e,"getInstance",function(){return L}),n.d(e,"Circle",function(){return m});var v={};function w(t,e){var n=new b(o(),t,e);return v[n.id]=n,console.log(n.id),n}function x(t){if(t)t.dispose();else{for(var e in v)v.hasOwnProperty(e)&&v[e].dispose();v={}}return this}function L(t){return v[t]}var b=function(t,e,n){n=n||{},this.dom=e,this.id=t;var i=new d,o=new _(e,i,n);new y(e,i,o);this.storage=i,this.painter=o,this._needsRefresh};b.prototype={constructor:b,getId:function(){return this.id},add:function(t){this.storage.addRoot(t),this._needsRefresh=!0,this.painter.refresh()},remove:function(t){this.storage.delRoot(t),this._needsRefresh=!0,this.painter.refresh()},refreshImmediately:function(){this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1},refresh:function(){this._needsRefresh=!0},getWidth:function(){return this.painter.getWidth()},getHeight:function(){return this.painter.getHeight()}}}])});