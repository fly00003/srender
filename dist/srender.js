!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.srender=e():t.srender=e()}(window,function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var i=2311,r=function(){return i++},o={},s=function(){return o.createCanvas()};function a(t,e){if(t){if(t.indexOf)return t.indexOf(e);for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n}return-1}o.createCanvas=function(){return console.log("createdom"),document.createElement("canvas")};var h=function(t){for(var e in t=t||{})t.hasOwnProperty(e)&&(this[e]=t[e]);this._children=[],this.__storage=null,this.__dirty=!0};h.prototype={constructor:h,isGroup:!0,type:"group",silent:!1,children:function(){return this._children.slice()},childAt:function(t){return this._children[t]},childOfName:function(t){for(var e=this._children,n=0;n<e.length;n++)if(e[n].name===t)return e[n]},childCount:function(){return this._children.length},add:function(t){return t&&t!==this&&t.parent!==this&&(this._children.push(t),this._doAdd(t)),this},addBefore:function(t,e){if(t&&t!==this&&t.parent!==this&&e&&e.parent===this){var n=this._children,i=n.indexOf(e);i>=0&&(n.splice(i,0,t),this._doAdd(t))}return this},_doAdd:function(t){t.parent&&t.parent.remove(t),t.parent=this;var e=this.__storage;this.__sr;e&&e!==t.__storage&&(e.addToStorage(t),t instanceof h&&t.addChildrenToStorage(e))},remove:function(t){var e=this.__sr,n=this.__storage,i=this._children,r=a(i,t);return r<0?this:(i.splice(r,1),t.parent=null,n&&(n.delFromStorage(t),t instanceof h&&t.delChildrenFromStorage(n)),e&&e.refresh(),this)},removeAll:function(){var t,e,n=this._children,i=this.__storage;for(e=0;e<n.length;e++)t=n[e],i&&(i.delFromStorage(t),t instanceof h&&t.delChildrenFromStorage(i)),t.parent=null;return n.length=0,this},eachChild:function(t,e){for(var n=this._children,i=0;i<n.length;i++){var r=n[i];t.call(e,r,i)}return this},traverse:function(t,e){for(var n=0;n<this._children.length;n++){var i=this._children[n];t.call(e,i),"group"===i.type&&i.traverse(t,e)}return this},traverse2:function(t,e,n){for(var i=0;!n.flag&&i<this._children.length;i++){var r=this._children[i];t.call(e,r),"group"===r.type&&r.traverse(t,e,n)}return this},addChildrenToStorage:function(t){for(var e=0;e<this._children.length;e++){var n=this._children[e];t.addToStorage(n),n instanceof h&&n.addChildrenToStorage(t)}},delChildrenFromStorage:function(t){for(var e=0;e<this._children.length;e++){var n=this._children[e];t.delFromStorage(n),n instanceof h&&n.delChildrenFromStorage(t)}},dirty:function(){return this.__dirty=!0,this.__sr&&this.__sr.refresh(),this}};var d=h,c=function(){this._roots=[],this._displayList=[],this._displayListLen=0};c.prototype={constructor:c,traverse:function(t,e){for(var n=0;n<this._roots.length;n++)this._roots[n].traverse(t,e)},getDisplayList:function(t){return t&&this.updateDisplayList(),this._displayList},updateDisplayList:function(){this._displayListLen=0;for(var t=this._roots,e=(this._displayList,0),n=t.length;e<n;e++){var i=t[e];this._displayList[this._displayListLen++]=i}},addRoot:function(t){t.__storage!==this&&(t instanceof d&&t.addChildrenToStorage(this),this.addToStorage(t),this._roots.push(t))},delRoot:function(t){if(null==t){for(var e=0;e<this._roots.length;e++){var n=this._roots[e];n instanceof d&&n.delChildrenFromStorage(this)}return this._roots=[],this._displayList=[],void(this._displayListLen=0)}if(t instanceof Array){e=0;for(var i=t.length;e<i;e++)this.delRoot(t[e])}else{var r=a(this._roots,t);r>=0&&(this.delFromStorage(t),this._roots.splice(r,1),t instanceof d&&t.delChildrenFromStorage(this))}},addToStorage:function(t){return t&&(t.__storage=this,t.dirty(!1)),this},delFromStorage:function(t){return t&&(t.__storage=null,t.__dirty=!0),this},dispose:function(){this._renderList=this._roots=null}};var u=c,l=1;"undefined"!=typeof window&&(l=Math.max(window.devicePixelRatio||1,1));var f=l;function p(t,e,n){var i=s(),r=e.getWidth(),o=e.getHeight();console.log("newDom");var a=i.style;return a&&(console.log("进入分支"),a.position="absolute",a.border="1px dashed gray",a.left=0,a.top=0,a.width=r+"px",a.height=o+"px",i.setAttribute("data-zr-dom-id",t)),console.log(r),console.log(o),i.width=1e3,i.height=800,console.log(i.width),console.log(i.height),i}var g=function(t,e,n){var i;n=n||f,"string"==typeof t?i=p(t,e):function(t){var e=typeof t;return"function"===e||!!t&&"object"==e}(t)&&(t=(i=t).id),i=p(t,e),this.id=t,this.dom=i,this.painter=e,this.dpr=n};g.prototype={constructor:g,__dirty:!0,__used:!1,__drawIndex:0,__startIndex:0,__endIndex:0,incremental:!1,getElementCount:function(){return this.__endIndex-this.__startIndex},initContext:function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},clear:function(){var t=this.dom,e=this.ctx,n=t.width,i=t.height;e.clearRect(0,0,n,i)}};var _=g;function v(t){return parseInt(t,10)}var y=function(t,e,n){this.root=t;var i=t.style;i&&(i["-webkit-tap-highlight-color"]="transparent",i["-webkit-user-select"]=i["user-select"]=i["-webkit-touch-callout"]="none",t.innerHTML=""),this.storage=e;this._layers={};var r=i.width,o=i.height;null!=n.width&&(r=n.width),null!=n.height&&(o=n.height),this.dpr=n.devicePixelRatio||1,t.width=r*this.dpr,t.height=o*this.dpr,this._width=r,this._height=o;var s=new _(t,this,this.dpr);s.__builtin__=!0,s.initContext(),this.tempLayer=s,t.appendChild(s.dom),this._domRoot=t,this.cnv=document.getElementsByTagName("canvas")[0]};y.prototype={constructor:y,getWidth:function(){return this._width},getHeight:function(){return this._height},getType:function(){return"canvas"},getViewportRoot:function(){return this._domRoot},refresh:function(t){var e=this.storage.getDisplayList(!0),n=this.storage._displayListLen,i=this.tempLayer.ctx;function r(t){i.beginPath(),t.buildPath(i,t.shape),i.stroke()}if(t){this.tempLayer.clear();for(var o=0;o<n;o++){(s=e[o])instanceof d?s.traverse(r,null):(i.beginPath(),i.stokeStyle="red",s.buildPath(i,s.shape),i.stroke()),s.__dirty=!1}}else for(o=0;o<n;o++){var s;!0===(s=e[o]).__dirty&&(s instanceof d?s.traverse(r,null):(i.beginPath(),i.stokeStyle="red",s.buildPath(i,s.shape),i.stroke()),s.__dirty=!1)}return this},_getSize:function(t){var e=this._opts,n=["width","height"][t],i=["clientWidth","clientHeight"][t],r=["paddingLeft","paddingTop"][t],o=["paddingRight","paddingBottom"][t];if(null!=e[n]&&"auto"!==e[n])return parseFloat(e[n]);var s=this.root,a=document.defaultView.getComputedStyle(s);return(s[i]||v(a[n])||v(s.style[n]))-(v(a[r])||0)-(v(a[o])||0)|0}};var m=y,w=("undefined"!=typeof window&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame),function(t,e,n){this.root=t,this.storage=e,this.painter=n;var i={x:0,y:0};n.cnv.addEventListener("mousemove",function(t){var e,r;(t=t||window.event).pageX||t.pageY?(e=t.pageX,r=t.pageY):(e=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,r=t.clientY+document.body.scrollTop+document.documentElement.scrollTop),e-=n.cnv.offsetLeft,r-=n.cnv.offsetTop,i.x=e,i.y=r},!1);var r=0,o=0,s=!1,a={flag:!1},h=null;function c(){var t={x:0,y:0};function e(e){if(e.trigger){let n=e.shape.cx,s=e.shape.cy;e.shape.cx=i.x-r,e.shape.cy=i.y-o,t.x=e.shape.cx-n,t.y=e.shape.cy-s}else e.shape.cx=e.shape.cx+t.x,e.shape.cy=e.shape.cy+t.y;console.log("_move"),console.log(e.shape.cx,e.shape.cy),e.__dirty=!0}h instanceof d&&h.traverse(e,null),null==h||h instanceof d||e(h)}function u(){r=o=0,h instanceof d?h.traverse(function(t){t.trigger=!1},null):h.trigger=!1,h=null,s=!1,document.removeEventListener("mouseup",u,!1),document.removeEventListener("mousemove",c,!1)}n.cnv.addEventListener("mousedown",function(){r=o=0;var t=e.getDisplayList(!0),n=e._displayListLen;function l(t){t.checkMouse(i)?(t.trigger=!0,console.log("mouwn"),s=!0,r=i.x-t.shape.cx,o=i.y-t.shape.cy,document.addEventListener("mousemove",c,!1),document.addEventListener("mouseup",u,!1),a.flag=!0):a.flag=!1}t:for(var f=0;f<n;f++)if((h=t[f])instanceof d){if(h.traverse2(l,null,a),a.flag)break t}else if(l(h),a.flag)break t},!1),setInterval(function(){s&&n.refresh(!0)},7)});function x(t){t=t||{},this.shape=t.shape||{cx:0,cy:0,r:20},this.position=t.position||[this.shape.cx,this.shape.cy],this.__dirty=!0,this.__sr=null,this.trigger=!1}x.prototype={checkMouse:function(t){var e=this.shape,n=t.x-e.cx,i=t.y-e.cy;return Math.sqrt(n*n+i*i)<e.r},dirty:function(){},buildPath:function(t,e){e=this.shape;t.arc(e.cx,e.cy,e.r,0,2*Math.PI,!0)}},n.d(e,"init",function(){return L}),n.d(e,"dispose",function(){return S}),n.d(e,"getInstance",function(){return R}),n.d(e,"Circle",function(){return x}),n.d(e,"Group",function(){return d});var b={};function L(t,e){var n=new C(r(),t,e);return b[n.id]=n,console.log(n.id),n}function S(t){if(t)t.dispose();else{for(var e in b)b.hasOwnProperty(e)&&b[e].dispose();b={}}return this}function R(t){return b[t]}var C=function(t,e,n){n=n||{},this.dom=e,this.id=t;var i=new u,r=new m(e,i,n);new w(e,i,r);this.storage=i,this.painter=r,this._needsRefresh};C.prototype={constructor:C,getId:function(){return this.id},add:function(t){this.storage.addRoot(t),this._needsRefresh=!0,this.painter.refresh()},remove:function(t){this.storage.delRoot(t),this._needsRefresh=!0,this.painter.refresh()},refreshImmediately:function(){this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1},refresh:function(){this._needsRefresh=!0},getWidth:function(){return this.painter.getWidth()},getHeight:function(){return this.painter.getHeight()}}}])});